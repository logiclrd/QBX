using System.Globalization;

namespace QBX.OperatingSystem.Globalization;

public class CharacterTables
{
	public static byte[] GetUppercaseTable(CultureInfo culture)
	{
		return GetUppercaseTable(culture.TextInfo.OEMCodePage, culture.Name);
	}

	public static byte[] GetFilenameUppercaseTable(CultureInfo culture)
	{
		return GetFilenameUppercaseTable(culture.TextInfo.OEMCodePage, culture.Name);
	}

	public static byte[] GetUppercaseTable(int codePage, string cultureName)
	{
		string[] cultureNameParts = cultureName.ToLowerInvariant().Split('-');

		string language = cultureNameParts[0];
		string country = cultureNameParts[1];

		int slash = country.IndexOf('/');

		if (slash >= 0)
			country = country.Substring(0, slash);

		switch (codePage)
		{
			case 437:
				switch (country)
				{
					case "us":
					case "uk":
					case "fr":
					case "gr":
					case "sp":
					case "la":
					case "it":
					case "af":
					case "as":
					case "jp":
					case "ko":
					case "pr":
					case "ta":
					case "br":
						return Uppercase.Latin437;
					case "ca":
						return (language == "fr") ? Uppercase.CanadianFrench437 : Uppercase.Latin437;
					case "be":
					case "fi":
					case "sv":
						return Uppercase.Scandinavian437;
					case "ch":
						return Uppercase.Switzerland437;
					case "nl":
						return Uppercase.Netherlands437;
				}

				break;
			case 850:
				switch (country)
				{
					case "us":
					case "afe":
					case "uk":
					case "fr":
					case "it":
					case "is":
					case "as":
					case "po":
					case "ca":
						return Uppercase.WesternEuropean850;
					case "gr":
						return Uppercase.Greek850;
					case "la":
					case "sp":
					case "be":
					case "fi":
					case "sv":
					case "dk":
					case "no":
						return Uppercase.Scandinavian850;
					case "ch":
						return Uppercase.Switzerland850;
					case "nl":
						return Uppercase.Netherlands850;
					case "tr":
					case "ic":
					case "yu":
					case "cs":
					case "sl":
					case "hu":
					case "pl":
						return Uppercase.EasternEuropean850;
					case "br":
						return Uppercase.Brazil850;

					default:
						return Uppercase.WesternEuropean850;
				}
			case 852: return Uppercase.Slavic852;
			case 857: return Uppercase.Turkey857;
			case 860: return Uppercase.Portuguese860;
			case 861: return Uppercase.Iceland861;
			case 862: return Uppercase.Israel862;
			case 865: return Uppercase.Nordic865;

			case 932:
			case 934:
			case 936:
			case 938:
				return Uppercase.Asian;

			default:
				goto case 437;
		}

		// Fallback
		return Uppercase.Latin437;
	}

	public static byte[] GetFilenameUppercaseTable(int codePage, string cultureName)
	{
		string[] cultureNameParts = cultureName.ToLowerInvariant().Split('-');

		string country = cultureNameParts[1];

		int slash = country.IndexOf('/');

		if (slash >= 0)
			country = country.Substring(0, slash);

		switch (codePage)
		{
			case 850:
				switch (country)
				{
					case "br":
					case "ic":
					case "tr":
					case "yu":
					case "cs":
					case "pl":
					case "hu":
					case "sl":
						return FilenameUppercase.EasternEuropean850IcelandAndBrazil;
				}

				break;
			case 852:
				return FilenameUppercase.EasternEuropean;
		}

		return FilenameUppercase.General;
	}

	class Uppercase
	{
		public static readonly byte[] Latin437 =
			[
				128,154,069,065,142,065,143,128,
				069,069,069,073,073,073,142,143,
				144,146,146,079,153,079,085,085,
				089,153,154,155,156,157,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] CanadianFrench437 =
			[
				067,085,069,065,065,065,134,067,
				069,069,069,073,073,141,065,143,
				069,069,069,079,069,073,085,085,
				152,079,085,155,156,085,085,159,
				160,161,079,085,164,165,166,167,
				073,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// dk, no
		public static readonly byte[] Nordic865 =
			[
				128,154,144,065,142,065,143,128,
				069,069,069,073,073,073,142,143,
				144,146,146,079,153,079,085,085,
				089,153,154,157,156,157,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// be, fi, sv
		public static readonly byte[] Scandinavian437 =
			[
				128,154,144,065,142,065,143,128,
				069,069,069,073,073,073,142,143,
				144,146,146,079,153,079,085,085,
				089,153,154,155,156,157,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Switzerland437 =
			[
				128,154,144,065,142,065,143,128,
				069,069,069,073,073,073,142,143,
				144,146,146,079,153,079,085,085,
				089,153,154,155,156,157,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Netherlands437 =
			[
				128,085,069,065,065,065,143,128,
				069,069,069,073,073,073,065,143,
				069,146,146,079,079,079,085,085,
				152,079,085,155,156,157,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Portuguese860 =
			[
				128,154,144,143,142,145,134,128,
				137,137,146,139,140,152,142,143,
				144,145,146,140,153,169,150,157,
				152,153,154,155,156,157,158,159,
				134,139,159,150,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Israel862 =
			[
				128,129,130,131,132,133,134,135,
				136,137,138,139,140,141,142,143,
				144,145,146,147,148,149,150,151,
				152,153,154,155,156,157,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// code page 850: us, afe, uk, fr, it, is, as, po, ca
		public static readonly byte[] WesternEuropean850 =
			[
				067,085,069,065,065,065,065,067,
				069,069,069,073,073,073,065,065,
				069,146,146,079,079,079,085,085,
				089,079,085,079,156,079,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,065,065,065,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,065,065,
				200,201,202,203,204,205,206,207,
				209,209,069,069,069,073,073,073,
				073,217,218,219,220,221,073,223,
				079,225,079,079,079,079,230,232,
				232,085,085,085,089,089,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// code page 850
		public static readonly byte[] Greek850 =
			[
				067,154,069,065,142,065,065,067,
				069,069,069,073,073,073,142,065,
				069,146,146,079,153,079,085,085,
				089,153,154,079,156,079,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,065,065,065,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,065,065,
				200,201,202,203,204,205,206,207,
				209,209,069,069,069,073,073,073,
				073,217,218,219,220,221,073,223,
				079,225,079,079,079,079,230,232,
				232,085,085,085,089,089,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// code page 850: la, sp, be, fi, sv, dk, no
		public static readonly byte[] Scandinavian850 =
			[
				128,154,144,182,142,183,143,128,
				210,211,212,216,215,222,142,143,
				144,146,146,226,153,227,234,235,
				089,153,154,157,156,157,158,159,
				181,214,224,233,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,199,199,
				200,201,202,203,204,205,206,207,
				209,209,210,211,212,073,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,229,229,230,232,
				232,233,234,235,237,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Switzerland850 =
			[
				128,154,144,182,142,183,143,128,
				210,211,212,216,215,222,142,143,
				144,146,146,226,153,227,234,235,
				089,153,154,157,156,157,158,159,
				181,214,224,233,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,199,199,
				200,201,202,203,204,205,206,207,
				209,209,210,211,212,073,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,229,229,230,232,
				232,233,234,235,237,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Netherlands850 =
			[
				128,085,069,065,065,065,143,128,
				069,069,069,073,073,073,065,143,
				069,146,146,079,079,079,085,085,
				152,079,085,079,156,079,158,159,
				065,073,079,085,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,065,065,065,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,065,065,
				200,201,202,203,204,205,206,207,
				209,209,069,069,069,073,073,073,
				073,217,218,219,220,221,073,223,
				079,225,079,079,079,079,230,232,
				232,085,085,085,089,089,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// jp932, ko934, pr936, ta938
		public static readonly byte[] Asian =
			[
				128,129,130,131,132,133,134,135,
				136,137,138,139,140,141,142,143,
				144,145,146,147,148,149,150,151,
				152,153,154,155,156,157,158,159,
				160,161,162,163,164,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Iceland861 =
			[
				128,154,144,065,142,065,143,128,
				069,069,069,139,139,141,142,143,
				144,146,146,079,153,141,085,151,
				151,153,154,157,156,157,158,159,
				164,165,166,167,164,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// code page 850: tr, ic, yu, cs, sl, hu, pl
		public static readonly byte[] EasternEuropean850 =
			[
				128,154,144,182,142,183,143,128,
				210,211,212,216,215,222,142,143,
				144,146,146,226,153,227,234,235,
				152,153,154,157,156,157,158,159,
				181,214,224,233,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,199,199,
				200,201,202,203,204,205,206,207,
				209,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,229,229,230,232,
				232,233,234,235,237,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Slavic852 =
			[
				128,154,144,182,142,222,143,128,
				157,211,138,138,215,141,142,143,
				144,145,145,226,153,149,149,151,
				151,153,154,155,155,157,158,172,
				181,214,224,233,164,164,166,166,
				168,168,170,141,172,184,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,189,191,
				192,193,194,195,196,197,198,198,
				200,201,202,203,204,205,206,207,
				209,209,210,211,210,213,214,215,
				183,217,218,219,220,221,222,223,
				224,225,226,227,227,213,230,230,
				232,233,232,235,237,237,221,239,
				240,241,242,243,244,245,246,247,
				248,249,250,235,252,252,254,255,
			];

		public static readonly byte[] Turkey857 =
			[
				128,154,144,182,142,183,143,128,
				210,211,212,216,215,073,142,143,
				144,146,146,226,153,227,234,235,
				152,153,154,157,156,157,158,158,
				181,214,224,233,165,165,166,166,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,199,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,073,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,229,229,230,231,
				232,233,234,235,222,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		public static readonly byte[] Brazil850 =
			[
				128,154,144,182,142,183,143,128,
				210,211,212,216,215,222,142,143,
				144,146,146,226,153,227,234,235,
				152,153,154,157,156,157,158,159,
				181,214,224,233,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,199,199,
				200,201,202,203,204,205,206,207,
				209,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,229,229,230,232,
				232,233,234,235,237,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];
	}

	class FilenameUppercase
	{
		// uk, fr, gr, sp, it, sv, dk, sw, no, nl, be, fi, is, ca, as, po, us, la, afe, br, tr, ic
		public static readonly byte[] General =
			[
				128,129,130,131,132,133,134,135,
				136,137,138,139,140,141,142,143,
				144,145,146,147,148,149,150,151,
				152,153,154,155,156,157,158,159,
				160,161,162,163,164,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,198,199,
				200,201,202,203,204,205,206,207,
				208,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,228,229,230,231,
				232,233,234,235,236,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// br, ic, tr, yu, cs, pl, hu, sl
		public static readonly byte[] EasternEuropean850IcelandAndBrazil =
			[
				128,154,144,182,142,183,143,128,
				210,211,212,216,215,222,142,143,
				144,146,146,226,153,227,234,235,
				152,153,154,157,156,157,158,159,
				181,214,224,233,165,165,166,167,
				168,169,170,171,172,173,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,190,191,
				192,193,194,195,196,197,199,199,
				200,201,202,203,204,205,206,207,
				209,209,210,211,212,213,214,215,
				216,217,218,219,220,221,222,223,
				224,225,226,227,229,229,230,232,
				232,233,234,235,237,237,238,239,
				240,241,242,243,244,245,246,247,
				248,249,250,251,252,253,254,255,
			];

		// yu, cs, sl, pl, hu
		public static readonly byte[] EasternEuropean =
			[
				128,154,144,182,142,222,143,128,
				157,211,138,138,215,141,142,143,
				144,145,145,226,153,149,149,151,
				151,153,154,155,155,157,158,172,
				181,214,224,233,164,164,166,166,
				168,168,170,141,172,184,174,175,
				176,177,178,179,180,181,182,183,
				184,185,186,187,188,189,189,191,
				192,193,194,195,196,197,198,198,
				200,201,202,203,204,205,206,207,
				209,209,210,211,210,213,214,215,
				183,217,218,219,220,221,222,223,
				224,225,226,227,227,213,230,230,
				232,233,232,235,237,237,221,239,
				240,241,242,243,244,245,246,247,
				248,249,250,235,252,252,254,255,
			];
	}
}
