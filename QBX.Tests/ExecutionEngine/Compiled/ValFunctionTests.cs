using QBX.ExecutionEngine.Compiled.Functions;

namespace QBX.Tests.ExecutionEngine.Compiled;

public class ValFunctionTests
{
	[TestCase("", 0)]
	[TestCase("0", 0)]
	[TestCase("00", 0)]
	[TestCase("0000000000000000000000", 0)]
	[TestCase("12345", 12345)]
	[TestCase(" 12345", 12345)]
	[TestCase("\t12345", 12345)]
	[TestCase("\r12345", 12345)]
	[TestCase("\n12345", 12345)]
	[TestCase(" \r\t\n\r  \r\n\t12345", 12345)]
	[TestCase("0M1", 0)]
	[TestCase("0.1", 0.1)]
	[TestCase("0.1M2", 0.1)]
	[TestCase("0.1E2", 10)]
	[TestCase("0.1D2", 10)]
	[TestCase("0.123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890", 0.12345678901234568)]
	[TestCase("12345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678", 1.2345678123456782e127)]
	[TestCase("12345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678E-10", 1.2345678123456782e127)]
	[TestCase("1234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567E-10", 1.2345678123456781e126)]
	[TestCase("123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456E-10", 1.234567812345678e125)]
	[TestCase("12345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345E-10", 1.2345678123456781e123)] // the window now sees "E-1"
	[TestCase("1234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234E-10", 1.234567812345678e113)] // the window now sees "E-1"
	public void PermissiveParse(string input, double expectedResult)
	{
		// Act
		var result = ValFunction.PermissiveParse(input);

		// Assert
		result.Should().Be(expectedResult);
	}
}
